image: python:3.10.1

pipelines:
   default:
      - step:
         caches:
         - pip
         name: Noxing CodeBase!ü•∂
         script:
         - pip install poetry
         - poetry add -D coverage
         - poetry add -D flake8 flake8-bugbear
         - poetry add -D mypy
         - poetry add -D --allow-prereleases black
         - pip install nox
         - nox
      
   branches:
      master:
         - step:
            name: Build and Push Docker Image ü™ê
            script:
               - echo $DOCKER_USERNAME $DOCKER_PASSWORD
               - docker login -u $DOCKER_USERNAME -p $DOCKER_PASSWORD
               - docker build -t jevan32:deg-x-api:latest .
               - docker push evan32:deg-x-api:latest
            services:
               - docker
           

   
